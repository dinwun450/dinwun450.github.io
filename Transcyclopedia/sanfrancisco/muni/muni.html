<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transcyclopedia San Francisco: San Francisco Municipal Transportation Agency (SFMTA)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="muni.css">
    <script src="muni.js"></script>
</head>

<body>
    <nav id="navbar">
        <a href="https://dinwun450.github.io/Transcyclopedia/trcypdia_main.html" class="brand">
            <!--<i class="fa-solid fa-earth-americas"></i>-->
            <span id="globe"><i class="fa-solid fa-earth-americas"></i></span>
            <span>Transcyclopedia</span>
        </a>
        <ul class="nav-links">
            <input type="checkbox" id="checkbox_toggle" />
            <label for="checkbox_toggle" class="hamburger">&#9776;</label>
            <div class="menu">
                <li style="--i:0;">
                    <a href="https://dinwun450.github.io/Transcyclopedia/trcypdia_main.html">
                        <span>Menu</span>
                        <span><ion-icon name="home-outline"></ion-icon></span>
                    </a>
                </li>
                <li style="--i:1;">
                    <a href="#">
                        <span>Agency</span>
                        <span><ion-icon name="business-outline"></ion-icon></span>
                    </a>
                </li>
                <li style="--i:2;">
                    <a href="#">
                        <span>Alerts</span>
                        <span><ion-icon name="warning-outline"></ion-icon></span>
                    </a>
                </li>
                <li style="--i:3;">
                    <a href="#">
                        <span>Lines</span>
                        <span><ion-icon name="map-outline"></ion-icon></span>
                    </a>
                </li>
                <li style="--i:4;">
                    <a href="#">
                        <span>About</span>
                        <span><ion-icon name="information-circle-outline"></ion-icon></span>
                    </a>
                </li>
            </div>
        </ul>
    </nav>
    <div class="main">
        <div class="topfooter">
            <h1 style="color: white;" id="titleofsection">San Francisco Muni</h1>
        </div>
        <div class="tab">
            <button class="tablinks" onclick="openTab(event, 'info')" id="defaulttab">About Muni</button>
            <button class="tablinks" onclick="openTab(event, 'lines')">Lines</button>
            <button class="tablinks" onclick="openTab(event, 'departures_metro')">Muni Metro</button>
            <button class="tablinks" onclick="openTab(event, 'departures_bus')">Bus</button>
            <button class="tablinks" onclick="openTab(event, 'departures_cable')">Cable Car</button>
        </div>

        <div id="info" class="tabcontent">
            <h2>About Muni</h2>
            <p id="about_content">
                The San Francisco Municipal Railway (SF Muni or Muni), is the public transit system for the City and
                County of San Francisco. It operates a system of bus routes (including trolleybuses), the Muni Metro
                light rail system, three historic cable car lines, and two historic streetcar lines. Previously an
                independent agency, the San Francisco Municipal Railway merged with two other agencies in 1999 to become
                the San Francisco Municipal Transportation Agency (SFMTA). In 2018, Muni served 46.7 square miles (121
                km2) with an operating budget of about $1.2 billion. Muni is the seventh-highest-ridership transit
                system in the United States, with 114,721,200 rides in 2022, and the second-highest in California after
                the Los Angeles County Metropolitan Transportation Authority.
                <a href="https://en.wikipedia.org/wiki/San_Francisco_Municipal_Railway">Wikipedia</a>
            </p>
        </div>
        <div id="lines" class="tabcontent">
            <h2>Lines</h2>
            <h4 class="buslines">Bus</h3>
            <ul id="muni_lines">
                <li id="each_line">
                    <div id="line">-</div>
                    <div id="route_desc">(Loading)</div>
                </li>
            </ul>
            <h4 class="metrolines">Metro</h4>
            <ul id="munimetrolines">
                <li id="each_line_metro">
                    <div id="line_metro">-</div>
                    <div id="route_desc_metro">(Loading)</div>
                </li>
            </ul>
            <h4 class="cablelines">Cable Car</h4>
            <ul id="municablelines">
                <li id="each_line_cable">
                    <div id="line_cable">-</div>
                    <div id="route_desc_cable">(Loading)</div>
                </li>
            </ul>
        </div>
        <div id="departures_metro" class="tabcontent">
            <h2>Muni Metro</h2>
            <input type="text" placeholder="Search for a station.." onkeydown="keyDown()" id="stationgetter"
                autocomplete="off">
            <p class="headerforstop">Departures for &nbsp;<span id="stationname">---</span></p>
            <ul id="list_of_departures">
                <li id="line_for_departure">
                    <div class="wrapper_for_departure">
                        <div id="line_for_each_departure">-</div> <div id="route_headsign"><p id="isscroll">(None)</p></div> <span id="route_depart">Enter a specific station by their number ID</span>
                    </div>
                </li>
            </ul>
            <h3>Alerts Today</h3>
            <ul id="list_of_alerts">
                <li id="alert_entity">
                    <p>Once you typed down the station by their ID, the advisories will display here.</p>
                </li>
            </ul>
            <button id="clearall" onclick="clearAll()">Clear</button>
        </div>
        <div id="departures_bus" class="tabcontent">
            <h2>Bus</h2>
            <input type="text" placeholder="Search for a station.." onkeydown="keyDownTwo()" id="busgetter"
                autocomplete="off">
            <p class="headerforstop2">Departures for &nbsp;<span id="stopname">---</span></p>
            <ul id="list_of_departures2">
                <li id="line_for_departure2">
                    <div class="wrapper_for_departure2">
                        <div id="line_for_each_departure2">-</div> <div id="route_headsign2"><p id="isscroll2">(None)</p></div> <span id="route_depart2">Enter a specific station by their stop ID</span>
                    </div>
                </li>
            </ul>
            <h3>Alerts Today</h3>
            <ul id="list_of_alerts2">
                <li id="alert_entity2">
                    <p>Once you typed down the station by their ID, the advisories will display here.</p>
                </li>
            </ul>
            <button id="clearall2" onclick="clearAll2()">Clear</button>
        </div>
        <div id="departures_cable" class="tabcontent">
            <h2>Cable Car</h2>
            <input type="text" placeholder="Search for a stop.. " onkeydown="keyDownThree()" id="cablegetter" autocomplete="off">
            <p class="headerforstop3">Departures for &nbsp;<span id="stopname3">---</span></p>
            <ul id="list_of_departures3">
                <li id="line_for_departure3">
                    <div class="wrapper_for_departure3">
                        <div id="line_for_each_departure3">-</div> <div id="route_headsign3"><p id="isscroll3">(None)</p></div> <span id="route_depart3">Enter a specific station by their stop ID</span>
                    </div>
                </li>
            </ul>
            <h3>Alerts Today</h3>
            <ul id="list_of_alerts3">
                <li id="alert_entity3">
                    <p>Once you typed down the station by their ID, the advisories will display here.</p>
                </li>
            </ul>
            <button id="clearall3" onclick="clearAll3()">Clear</button>
        </div>
    </div>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script>
        let lastScrollTop = 0;
        var deviceWidth = window.innerWidth;
        var counter = 0;
        var counter_b = 0;

        navbar = document.getElementById("navbar");
        window.addEventListener("scroll", function () {
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if (scrollTop > lastScrollTop) {
                navbar.classList.add("icon");
            } else {
                navbar.classList.remove("icon");
            }
            lastScrollTop = scrollTop;
        })

        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
        document.getElementById("defaulttab").click();

        function keyDown(e) {
            e = e || window.event;
            if (e.keyCode === 13) {
                console.log("Here we go!");
                callOver();
            }
        }

        function keyDownTwo(e) {
            e = e || window.event;
            if (e.keyCode === 13) {
                callOverBus();
            }
        }

        function keyDownThree(e) {
            e = e || window.event;
            if (e.keyCode === 13) {
                callOverCable();
            }
        }

        function callOver() {
            getValue = document.getElementById("stationgetter").value;
            var departureCall = new XMLHttpRequest();
            departureCall.open("GET", `https://transit.land/api/v2/rest/stops?served_by_onestop_ids=o-9q8y-sfmta&served_by_route_type=0&stop_id=${getValue}&api_key=x5unflDSbpKEWnThyfmteM8MHxIsg3eL`);
            departureCall.onreadystatechange = function () {
                if (departureCall.readyState === 4 && departureCall.status === 200) {
                    var stopIdExtraction = JSON.parse(departureCall.responseText);
                    console.log(stopIdExtraction);

                    if (stopIdExtraction.stops.length === 0) {
                        console.log("Nothing to do about it...")
                    }
                    else {
                        var stopCodeSpecified = stopIdExtraction.stops[0].stop_code;
                        var stopName = stopIdExtraction.stops[0].stop_name;
                        console.log(stopCodeSpecified);
                        document.getElementById("stationname").innerHTML = stopName;
                        gatherDepartures(stopCodeSpecified);
                    }
                }
            }
            departureCall.send();
        }

        function callOverBus() {
            getValueForBus = document.getElementById("busgetter").value;
            var departureCallByBus = new XMLHttpRequest();
            departureCallByBus.open("GET", `https://transit.land/api/v2/rest/stops?served_by_onestop_ids=o-9q8y-sfmta&served_by_route_type=3&stop_id=${getValueForBus}&api_key=x5unflDSbpKEWnThyfmteM8MHxIsg3eL`);
            departureCallByBus.onreadystatechange = function () {
                if (departureCallByBus.readyState === 4 && departureCallByBus.status === 200) {
                    var stopIdExtraction = JSON.parse(departureCallByBus.responseText);
                    console.log(stopIdExtraction);

                    if (stopIdExtraction.stops.length === 0) {
                        console.log("Nothing to do about it...")
                    }
                    else {
                        var stopCodeSpecifiedByBus = stopIdExtraction.stops[0].stop_code;
                        var stopName = stopIdExtraction.stops[0].stop_name;
                        console.log(stopCodeSpecifiedByBus);
                        document.getElementById("stopname").innerHTML = stopName;
                        gatherDeparturesForBus(stopCodeSpecifiedByBus);
                    }
                }
            }
            departureCallByBus.send();
        }

        function callOverCable() {
            getValueForCable = document.getElementById("cablegetter").value;
            var departureCallByCable = new XMLHttpRequest();
            departureCallByCable.open("GET", `https://transit.land/api/v2/rest/stops?served_by_onestop_ids=o-9q8y-sfmta&served_by_route_type=5&stop_id=${getValueForCable}&api_key=x5unflDSbpKEWnThyfmteM8MHxIsg3eL`);
            departureCallByCable.onreadystatechange = function() {
                if (departureCallByCable.readyState === 4 && departureCallByCable.status === 200) {
                    var stopIdExtraction = JSON.parse(departureCallByCable.responseText);
                    console.log(stopIdExtraction);

                    if (stopIdExtraction.stops.length === 0) {
                        console.log("Nothing to do about it...")
                    }
                    else {
                        var stopCodeSpecifiedByBus = stopIdExtraction.stops[0].stop_code;
                        var stopName = stopIdExtraction.stops[0].stop_name;
                        console.log(stopCodeSpecifiedByBus);
                        document.getElementById("stopname3").innerHTML = stopName;
                        gatherDeparturesForCable(stopCodeSpecifiedByBus);
                    }
                }
            }
            departureCallByCable.send();
        }

        function gatherDeparturesForBus(stopCodeBus) {
            var secondDepartureRequest = new XMLHttpRequest();
            secondDepartureRequest.open("GET", `https://transit.land/api/v2/rest/stops/f-sf~bay~area~rg:${stopCodeBus}/departures?api_key=x5unflDSbpKEWnThyfmteM8MHxIsg3eL&include_alerts=true`);
            secondDepartureRequest.onreadystatechange = function () {
                if (secondDepartureRequest.readyState === 4 && secondDepartureRequest.status === 200) {
                    var compileDepartures = JSON.parse(secondDepartureRequest.responseText);
                    console.log(compileDepartures);

                    for (var i = 0; i < compileDepartures.stops[0].departures.length; i++) {
                        var routeColor = compileDepartures.stops[0].departures[i].trip.route.route_color;
                        var routeColorInText = compileDepartures.stops[0].departures[i].trip.route.route_text_color;
                        var routeShort = compileDepartures.stops[0].departures[i].trip.route.route_short_name;
                        var routeLong = compileDepartures.stops[0].departures[i].trip.trip_headsign;
                        var routeFullName = compileDepartures.stops[0].departures[i].trip.route.route_long_name;
                        var departuredTime = compileDepartures.stops[0].departures[i].arrival.estimated;
                        var scheduledTime = compileDepartures.stops[0].departures[i].arrival.scheduled;

                        if (departuredTime === null) {
                            document.getElementById("route_depart2").innerHTML = ` ${scheduledTime} (scheduled)`;
                            document.getElementById("route_depart2").style.color = "black";
                        }
                        else if (scheduledTime === null) {
                            continue
                        }
                        else {
                            document.getElementById("route_depart2").innerHTML = ` ${departuredTime} <span id="delay2">()</span>`;
                            document.getElementById("route_depart2").style.color = "darkgreen";

                            if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay >= 60) {
                                document.getElementById("delay2").innerHTML = `(${Math.floor(compileDepartures.stops[0].departures[i].arrival.delay / 60)} min late)`;
                                document.getElementById("delay2").style.color = "crimson";
                            }
                            else if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay === 0) {
                                document.getElementById("delay2").innerHTML = `(on time)`;
                                document.getElementById("delay2").style.color = "green";
                            }
                            else if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay <= 0) {
                                document.getElementById("delay2").innerHTML = `(${Math.abs(Math.floor(compileDepartures.stops[0].departures[i].arrival.delay / 60))} min early)`;
                                document.getElementById("delay2").style.color = "skyblue";
                            }
                            else {
                                document.getElementById("delay2").innerHTML = "(no data)";
                                document.getElementById("delay2").style.color = "black";
                            }
                        }

                        document.getElementById("line_for_each_departure2").innerHTML = routeShort;
                        document.getElementById("line_for_each_departure2").style.backgroundColor = `#${routeColor}40`;
                        document.getElementById("line_for_each_departure2").style.border = `1px solid #${routeColor}`;
                        document.getElementById("line_for_each_departure2").style.color = `#${routeColorInText}`;
                        document.getElementById("route_headsign2").innerHTML = `<p id="isscroll2">${routeFullName} ${routeLong}</p>`;

                        if (deviceWidth <= 520 && document.getElementById("route_headsign2").innerText.length > 35) {
                            console.log("Scroll?")
                            document.getElementById("isscroll2").style.transform = "translateX(200vw)";
                            document.getElementById("isscroll2").style.animation = "my-animation-6 10s linear infinite";
                        }

                        var departureClone = document.getElementById("line_for_departure2");
                        var listToInsertClone = departureClone.cloneNode(true);
                        document.getElementById("list_of_departures2").appendChild(listToInsertClone);

                        var alertList_byAgency = compileDepartures.stops[0].departures[i].trip.route.agency.alerts;
                        var alertList_byStop = compileDepartures.stops[0].alerts;

                        for (var j = 0; j < alertList_byAgency.length; j++) {
                            if (counter_b === alertList_byAgency.length) {
                                break;
                            }
                            document.getElementById("alert_entity2").innerHTML = `<p>${alertList_byAgency[j].description_text[0].text}</p>`;
                            console.log(document.getElementById("alert_entity2").textContent);

                            var alertClone = document.getElementById("alert_entity2");
                            var listToInsertAlertClone = alertClone.cloneNode(true);
                            document.getElementById("list_of_alerts2").appendChild(listToInsertAlertClone);
                            console.log(counter);
                            counter_b += 1
                        }

                        for (var k = 0; k < alertList_byStop.length; k++) {
                            if (counter === alertList_byStop.length) {
                                break;
                            }
                            document.getElementById("alert_entity2").innerHTML = `<p>${alertList_byStop[k].description_text[0].text}</p>`;

                            var alertClone = document.getElementById("alert_entity2");
                            var listToInsertAlertClone = alertClone.cloneNode(true);
                            document.getElementById("list_of_alerts2").appendChild(listToInsertAlertClone);
                            console.log(counter);
                            counter += 1
                        }
                    }

                    var departuresAll = document.getElementById("list_of_departures2").children;
                    document.querySelector("#list_of_departures2").removeChild(departuresAll[0]);

                    var alertsAll = document.getElementById("list_of_alerts2").children;
                    document.querySelector("#list_of_alerts2").removeChild(alertsAll[0]);
                }
            }
            secondDepartureRequest.send();
        }

        function gatherDeparturesForCable(stopCodeCable) {
            var thirdDepartureRequest = new XMLHttpRequest();
            thirdDepartureRequest.open("GET", `https://transit.land/api/v2/rest/stops/f-sf~bay~area~rg:${stopCodeCable}/departures?api_key=x5unflDSbpKEWnThyfmteM8MHxIsg3eL&include_alerts=true`);
            thirdDepartureRequest.onreadystatechange = function () {
                if (thirdDepartureRequest.readyState === 4 && thirdDepartureRequest.status === 200) {
                    var compileDepartures = JSON.parse(thirdDepartureRequest.responseText);
                    console.log(compileDepartures);

                    for (var i = 0; i < compileDepartures.stops[0].departures.length; i++) {
                        var routeColor = compileDepartures.stops[0].departures[i].trip.route.route_color;
                        var routeColorInText = compileDepartures.stops[0].departures[i].trip.route.route_text_color;
                        var routeShort = compileDepartures.stops[0].departures[i].trip.route.route_short_name;
                        var routeLong = compileDepartures.stops[0].departures[i].trip.trip_headsign;
                        var routeFullName = compileDepartures.stops[0].departures[i].trip.route.route_long_name;
                        var departuredTime = compileDepartures.stops[0].departures[i].arrival.estimated;
                        var scheduledTime = compileDepartures.stops[0].departures[i].arrival.scheduled;

                        if (departuredTime === null) {
                            document.getElementById("route_depart3").innerHTML = ` ${scheduledTime} (scheduled)`;
                            document.getElementById("route_depart3").style.color = "black";
                        }
                        else if (scheduledTime === null) {
                            continue
                        }
                        else {
                            document.getElementById("route_depart3").innerHTML = ` ${departuredTime} <span id="delay3">()</span>`;
                            document.getElementById("route_depart3").style.color = "darkgreen";

                            if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay >= 60) {
                                document.getElementById("delay3").innerHTML = `(${Math.floor(compileDepartures.stops[0].departures[i].arrival.delay / 60)} min late)`;
                                document.getElementById("delay3").style.color = "crimson";
                            }
                            else if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay === 0) {
                                document.getElementById("delay3").innerHTML = `(on time)`;
                                document.getElementById("delay3").style.color = "green";
                            }
                            else if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay <= 0) {
                                document.getElementById("delay3").innerHTML = `(${Math.abs(Math.floor(compileDepartures.stops[0].departures[i].arrival.delay / 60))} min early)`;
                                document.getElementById("delay3").style.color = "skyblue";
                            }
                            else {
                                document.getElementById("delay3").innerHTML = "(no data)";
                                document.getElementById("delay3").style.color = "black";
                            }
                        }

                        document.getElementById("line_for_each_departure3").innerHTML = routeShort;
                        document.getElementById("line_for_each_departure3").style.backgroundColor = `#${routeColor}40`;
                        document.getElementById("line_for_each_departure3").style.border = `1px solid #${routeColor}`;
                        document.getElementById("line_for_each_departure3").style.color = `#${routeColorInText}`;
                        document.getElementById("route_headsign3").innerHTML = `<p id="isscroll3">${routeFullName} ${routeLong}</p>`;

                        if (deviceWidth <= 520 && document.getElementById("route_headsign2").innerText.length > 35) {
                            console.log("Scroll?")
                            document.getElementById("isscroll3").style.transform = "translateX(200vw)";
                            document.getElementById("isscroll3").style.animation = "my-animation-6 10s linear infinite";
                        }

                        var departureClone = document.getElementById("line_for_departure3");
                        var listToInsertClone = departureClone.cloneNode(true);
                        document.getElementById("list_of_departures3").appendChild(listToInsertClone);

                        var alertList_byAgency = compileDepartures.stops[0].departures[i].trip.route.agency.alerts;
                        var alertList_byStop = compileDepartures.stops[0].alerts;
                        
                        for (var j = 0; j < alertList_byAgency.length; j++) {
                            if (counter_b === alertList_byAgency.length) {
                                break;
                            }
                            document.getElementById("alert_entity3").innerHTML = `<p>${alertList_byAgency[j].description_text[0].text}</p>`;
                            console.log(document.getElementById("alert_entity3").textContent);

                            var alertClone = document.getElementById("alert_entity3");
                            var listToInsertAlertClone = alertClone.cloneNode(true);
                            document.getElementById("list_of_alerts3").appendChild(listToInsertAlertClone);
                            console.log(counter);
                            counter_b += 1
                        }

                        for (var k = 0; k < alertList_byStop.length; k++) {
                            if (counter === alertList_byStop.length) {
                                break;
                            }
                            document.getElementById("alert_entity3").innerHTML = `<p>${alertList_byStop[k].description_text[0].text}</p>`;

                            var alertClone = document.getElementById("alert_entity3");
                            var listToInsertAlertClone = alertClone.cloneNode(true);
                            document.getElementById("list_of_alerts3").appendChild(listToInsertAlertClone);
                            console.log(counter);
                            counter += 1
                        }
                    }

                    var departuresAll = document.getElementById("list_of_departures3").children;
                    document.querySelector("#list_of_departures3").removeChild(departuresAll[0]);

                    var alertsAll = document.getElementById("list_of_alerts3").children;
                    document.querySelector("#list_of_alerts3").removeChild(alertsAll[0]);
                }
            }
            thirdDepartureRequest.send();
        }

        function gatherDepartures(stopCode) {
            var secondDepartureRequest = new XMLHttpRequest();
            secondDepartureRequest.open("GET", `https://transit.land/api/v2/rest/stops/f-sf~bay~area~rg:${stopCode}/departures?api_key=x5unflDSbpKEWnThyfmteM8MHxIsg3eL&include_alerts=true`);
            secondDepartureRequest.onreadystatechange = function () {
                if (secondDepartureRequest.readyState === 4 && secondDepartureRequest.status === 200) {
                    var compileDepartures = JSON.parse(secondDepartureRequest.responseText);
                    console.log(compileDepartures);

                    for (var i = 0; i < compileDepartures.stops[0].departures.length; i++) {
                        var routeColor = compileDepartures.stops[0].departures[i].trip.route.route_color;
                        var routeColorInText = compileDepartures.stops[0].departures[i].trip.route.route_text_color;
                        var routeShort = compileDepartures.stops[0].departures[i].trip.route.route_short_name;
                        var routeLong = compileDepartures.stops[0].departures[i].trip.trip_headsign;
                        var routeFullName = compileDepartures.stops[0].departures[i].trip.route.route_long_name;
                        var departuredTime = compileDepartures.stops[0].departures[i].arrival.estimated;
                        var scheduledTime = compileDepartures.stops[0].departures[i].arrival.scheduled;

                        if (departuredTime === null) {
                            document.getElementById("route_depart").innerHTML = ` ${scheduledTime} (scheduled)`;
                            document.getElementById("route_depart").style.color = "black";
                        }
                        else if (scheduledTime === null) {
                            continue
                        }
                        else {
                            document.getElementById("route_depart").innerHTML = ` ${departuredTime} <span id="delay">()</span>`;
                            document.getElementById("route_depart").style.color = "darkgreen";

                            if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay >= 60) {
                                document.getElementById("delay").innerHTML = `(${Math.floor(compileDepartures.stops[0].departures[i].arrival.delay / 60)} min late)`;
                                document.getElementById("delay").style.color = "crimson";
                            }
                            else if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay === 0) {
                                document.getElementById("delay").innerHTML = `(on time)`;
                                document.getElementById("delay").style.color = "green";
                            }
                            else if (departuredTime = compileDepartures.stops[0].departures[i].arrival.delay <= 0) {
                                document.getElementById("delay").innerHTML = `(${Math.abs(Math.floor(compileDepartures.stops[0].departures[i].arrival.delay / 60))} min early)`;
                                document.getElementById("delay").style.color = "skyblue";
                            }
                            else {
                                document.getElementById("delay").innerHTML = "(no data)";
                                document.getElementById("delay").style.color = "black";
                            }
                        }

                        document.getElementById("line_for_each_departure").innerHTML = routeShort;
                        document.getElementById("line_for_each_departure").style.backgroundColor = `#${routeColor}40`;
                        document.getElementById("line_for_each_departure").style.border = `1px solid #${routeColor}`;
                        document.getElementById("line_for_each_departure").style.color = `#${routeColorInText}`;
                        document.getElementById("route_headsign").innerHTML = `<p id="isscroll">${routeFullName} ${routeLong}</p>`;

                        if (deviceWidth <= 520 && document.getElementById("route_headsign").innerText.length > 35) {
                            console.log("Scroll?")
                            document.getElementById("isscroll").style.transform = "translateX(200vw)";
                            document.getElementById("isscroll").style.animation = "my-animation-6 10s linear infinite";
                        }

                        var departureClone = document.getElementById("line_for_departure");
                        var listToInsertClone = departureClone.cloneNode(true);
                        document.getElementById("list_of_departures").appendChild(listToInsertClone);

                        var alertList_byAgency = compileDepartures.stops[0].departures[i].trip.route.agency.alerts;
                        var alertList_byStop = compileDepartures.stops[0].alerts;

                        for (var j = 0; j < alertList_byAgency.length; j++) {
                            if (counter_b === alertList_byAgency.length) {
                                break;
                            }
                            document.getElementById("alert_entity").innerHTML = `<p>${alertList_byAgency[j].description_text[0].text}</p>`;
                            console.log(document.getElementById("alert_entity").textContent);

                            var alertClone = document.getElementById("alert_entity");
                            var listToInsertAlertClone = alertClone.cloneNode(true);
                            document.getElementById("list_of_alerts").appendChild(listToInsertAlertClone);
                            console.log(counter);
                            counter_b += 1
                        }

                        for (var k = 0; k < alertList_byStop.length; k++) {
                            if (counter === alertList_byStop.length) {
                                break;
                            }
                            document.getElementById("alert_entity").innerHTML = `<p>${alertList_byStop[k].description_text[0].text}</p>`;

                            var alertClone = document.getElementById("alert_entity");
                            var listToInsertAlertClone = alertClone.cloneNode(true);
                            document.getElementById("list_of_alerts").appendChild(listToInsertAlertClone);
                            console.log(counter);
                            counter += 1
                        }
                    }

                    var departuresAll = document.getElementById("list_of_departures").children;
                    document.querySelector("#list_of_departures").removeChild(departuresAll[0]);

                    var alertsAll = document.getElementById("list_of_alerts").children;
                    document.querySelector("#list_of_alerts").removeChild(alertsAll[0]);
                }
            }
            secondDepartureRequest.send();
        }

        function clearAll() {
            document.getElementById("list_of_departures").innerHTML = `
            <li id="line_for_departure"><div class="wrapper_for_departure"><div id="line_for_each_departure">-</div> <span id="route_headsign">(None)</span> <span id="route_depart">Enter a specific station by their stop ID</span></div></li>
            `
            document.getElementById("stationname").innerHTML = "---";
            document.getElementById("list_of_alerts").innerHTML = "<li id='alert_entity'></li>"
            document.getElementById("alert_entity").innerHTML = `<p>Once you typed down the station by their ID, the advisories will display here.</p>`
            counter = 0;
            counter_b = 0;
        }

        function clearAll2() {
            document.getElementById("list_of_departures2").innerHTML = `
            <li id="line_for_departure2"><div class="wrapper_for_departure2"><div id="line_for_each_departure2">-</div> <span id="route_headsign2">(None)</span> <span id="route_depart2">Enter a specific station by their stop ID</span></div></li>
            `
            document.getElementById("stopname").innerHTML = "---";
            document.getElementById("list_of_alerts2").innerHTML = "<li id='alert_entity2'></li>"
            document.getElementById("alert_entity2").innerHTML = `<p>Once you typed down the station by their ID, the advisories will display here.</p>`
            counter = 0;
            counter_b = 0;
        }

        function clearAll3() {
            document.getElementById("list_of_departures3").innerHTML = `
            <li id="line_for_departure3"><div class="wrapper_for_departure3"><div id="line_for_each_departure3">-</div> <span id="route_headsign3">(None)</span> <span id="route_depart3">Enter a specific station by their stop ID</span></div></li>
            `
            document.getElementById("stopname3").innerHTML = "---";
            document.getElementById("list_of_alerts3").innerHTML = "<li id='alert_entity3'></li>"
            document.getElementById("alert_entity3").innerHTML = `<p>Once you typed down the station by their ID, the advisories will display here.</p>`
            counter = 0;
            counter_b = 0;
        }
    </script>
</body>

</html>